# Configuration file for pre-commit (https://pre-commit.com/).
# Please run `pre-commit run --all-files` when adding or changing entries.

repos:
  - repo: local
    hooks:
      - id: alejandra
        name: alejandra
        entry: alejandra
        files: \.nix$
        language: system
        stages: [commit]

      - id: gitlint
        name: gitlint
        entry: gitlint
        args: [--staged, --msg-filename]
        language: system
        stages: [commit-msg]

      - id: jupyter-clean
        name: jupyter-clean
        entry: jupyter
        args:
          [nbconvert, --clear-output, --ClearMetadataPreprocessor.enabled=True]
        types: [jupyter]
        language: system
        stages: [commit]

      - id: pathchk
        name: pathchk
        entry: pathchk
        args: [--portability]
        types: [file]
        exclude: ^([a-zA-Z0-9._][a-zA-Z0-9._-]+)(/[a-zA-Z0-9._][a-zA-Z0-9._-]+)*$ # https://lists.gnu.org/archive/html/coreutils/2023-01/msg00006.html
        language: system
        stages: [commit]

      - id: prettier
        name: prettier
        entry: prettier
        args: [--ignore-unknown, --list-different, --write]
        types: [text]
        language: system
        stages: [commit]

      - id: shellcheck
        name: shellcheck
        entry: shellcheck
        types: [shell]
        language: system
        stages: [commit]

      # TODO: Kill if https://github.com/pre-commit/identify/issues/350 is fixed
      - id: shellcheck_other
        name: shellcheck other
        entry: shellcheck
        files: ^\.envrc$
        language: system
        stages: [commit]

      - id: shfmt
        name: Format shell scripts
        entry: shfmt
        args: [--case-indent, --indent=4, --list, --space-redirects, --write]
        types: [shell]
        language: system
        stages: [commit]

      # TODO: Kill if https://github.com/pre-commit/identify/issues/350 is fixed
      - id: shfmt_other
        name: Format other shell scripts
        entry: shfmt
        args: [--case-indent, --indent=4, --list, --space-redirects, --write]
        files: ^\.envrc$
        language: system
        stages: [commit]

      - id: statix
        name: statix
        entry: statix
        args: [check]
        files: \.nix$
        pass_filenames: false
        language: system
        stages: [commit]

      - id: nbqa-mypy
        name: nbqa-mypy
        description: Run 'mypy' on Jupyter notebooks
        entry: nbqa
        args: [mypy]
        require_serial: true
        types_or: [jupyter, markdown]
        language: system
        stages: [commit]

  - repo: https://github.com/nbQA-dev/nbQA
    rev: 73e47d5a94b8724ce0b36e7bf29103a6f45dc505 # frozen: 1.6.1
    hooks:
      - id: nbqa-black
      - id: nbqa-isort
      - id: nbqa-pydocstyle

  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 00337e660434e648317dbaf2bbaca4966953da22 # frozen: 0.20.0
    hooks:
      - id: check-github-workflows

  - repo: meta
    hooks:
      - id: check-useless-excludes
